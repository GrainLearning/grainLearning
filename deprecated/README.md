# README #

A calibration tool for discrete element models of granular materials using the particle filter

Monte Carlo simulations are conducted with YADE. An initial 'stress-free' granular packing, experimental data (e.g., triaxial response) and parameter sets of DEM models are needed. Each parameter set is referred as a 'particle' which is generated from Halton sequence. The numbers of DEM simulation and experimental measurement steps must be the same. The identified parameters come in the forms of probability density functions if the covariance is chosen properly.

The following packages are needed:

* Primary:

    Discrete Element Method: Yade (http://yade-dem.org/)

    Halton number generator: ghalton (https://pypi.python.org/pypi/ghalton)

    Particle filter code:    particle_filter.f90 (compilable with gfortran)

* Others:

    numpy

    matplotlib
 
Files

   *./PeriSp_1000_0.68 contains the coordinates of 1000 spheres in a granular assembly which has an initial void ratio of 0.68 and negligible inter-sphere forces

   *./mcTriax.py is a python script for running DEM simulations of quasi-static drained triaxial compression on Toyoura sand (e_0 = 0.68) under 0.5 MPa confining pressure. In this example Cundall's linear force-displacement law is implemented to govern inter-sphere behaviors

   *./particle_filter.f90 is the particle filtering algorithm coded in Fortran

   *./example contains the following files that constitute a minimal working example
     
     Python scripts:

        1. main: findParams.py is the main script which executes the complete parameter identification procedures. The Monte Carlo simulation data are saved in ./example/mcSimulations/

        2. Halton number: tableGenerator.py generates the input parameter sets (particles) in table.dat from a Halton sequence

        3. plot figures: plotResults.py plots the evolution of weighted average of each parameter and the distribution of weights versus the NO. of particle at selected steps
     
     Data files:
       
        1. parameter table: table.dat contains the input parameters to be read by ./mcTriax.py

        2. test data: triaxial response of Toyoura sand under 0.5 confining pressure is saved in obsdata.dat. Data are extracted every 0.1% axial strain until compression reaches 10%

        3. Identified parameter values: IP.txt contains the data to plot the evolution of weighted averages of parameters
 
        4. Weights: weight.txt contains the data to plot the distribution of weights versus the NO. of particle at selected steps

     Others are generated by the main script as input data of the executable PF.exe
