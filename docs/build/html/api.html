<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Python API &mdash; GrainLearning  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="How to contribute" href="how_to_contribute.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            GrainLearning
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic_systems.html">Dynamic systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="iterative_bayesian_filter.html">Iterative Bayesian Filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to_contribute.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to_contribute.html#contributing-guidelines">Contributing guidelines</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-grainlearning.bayesian_calibration"><code class="docutils literal notranslate"><span class="pre">Calibration</span> <span class="pre">toolbox</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#grainlearning.bayesian_calibration.BayesianCalibration"><code class="docutils literal notranslate"><span class="pre">BayesianCalibration</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.bayesian_calibration.BayesianCalibration.from_dict"><code class="docutils literal notranslate"><span class="pre">BayesianCalibration.from_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.bayesian_calibration.BayesianCalibration.get_most_prob_params"><code class="docutils literal notranslate"><span class="pre">BayesianCalibration.get_most_prob_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.bayesian_calibration.BayesianCalibration.load_and_process"><code class="docutils literal notranslate"><span class="pre">BayesianCalibration.load_and_process()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.bayesian_calibration.BayesianCalibration.load_and_run_one_iteration"><code class="docutils literal notranslate"><span class="pre">BayesianCalibration.load_and_run_one_iteration()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.bayesian_calibration.BayesianCalibration.load_system"><code class="docutils literal notranslate"><span class="pre">BayesianCalibration.load_system()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.bayesian_calibration.BayesianCalibration.plot_uq_in_time"><code class="docutils literal notranslate"><span class="pre">BayesianCalibration.plot_uq_in_time()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.bayesian_calibration.BayesianCalibration.resample"><code class="docutils literal notranslate"><span class="pre">BayesianCalibration.resample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.bayesian_calibration.BayesianCalibration.run"><code class="docutils literal notranslate"><span class="pre">BayesianCalibration.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.bayesian_calibration.BayesianCalibration.run_one_iteration"><code class="docutils literal notranslate"><span class="pre">BayesianCalibration.run_one_iteration()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.bayesian_calibration.BayesianCalibration.calibration"><code class="docutils literal notranslate"><span class="pre">BayesianCalibration.calibration</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.bayesian_calibration.BayesianCalibration.curr_iter"><code class="docutils literal notranslate"><span class="pre">BayesianCalibration.curr_iter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.bayesian_calibration.BayesianCalibration.num_iter"><code class="docutils literal notranslate"><span class="pre">BayesianCalibration.num_iter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.bayesian_calibration.BayesianCalibration.save_fig"><code class="docutils literal notranslate"><span class="pre">BayesianCalibration.save_fig</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.bayesian_calibration.BayesianCalibration.system"><code class="docutils literal notranslate"><span class="pre">BayesianCalibration.system</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-grainlearning.dynamic_systems"><code class="docutils literal notranslate"><span class="pre">Dynamic</span> <span class="pre">systems</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem"><code class="docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.compute_estimated_params"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.compute_estimated_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.compute_inv_normalized_sigma"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.compute_inv_normalized_sigma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.from_dict"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.from_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.get_inv_normalized_sigma"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.get_inv_normalized_sigma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.get_sim_data_files"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.get_sim_data_files()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.load_param_data"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.load_param_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.load_sim_data"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.load_sim_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.run"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.set_sim_data"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.set_sim_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.write_to_table"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.write_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.callback"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.callback</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.ctrl_data"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.ctrl_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.ctrl_name"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.ctrl_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.estimated_params"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.estimated_params</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.estimated_params_CV"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.estimated_params_CV</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.inv_obs_weight"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.inv_obs_weight</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.num_ctrl"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.num_ctrl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.num_obs"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.num_obs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.num_params"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.num_params</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.num_samples"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.num_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.num_steps"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.num_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.obs_data"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.obs_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.obs_names"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.obs_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.param_data"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.param_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.param_data_prev"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.param_data_prev</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.param_max"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.param_max</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.param_min"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.param_min</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.param_names"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.param_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.sigma_max"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.sigma_max</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.sigma_min"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.sigma_min</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.sigma_tol"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.sigma_tol</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.sim_data"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.sim_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.sim_name"><code class="docutils literal notranslate"><span class="pre">DynamicSystem.sim_name</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.compute_estimated_params"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.compute_estimated_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.compute_inv_normalized_sigma"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.compute_inv_normalized_sigma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.from_dict"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.from_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.get_inv_normalized_sigma"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.get_inv_normalized_sigma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.get_obs_data"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.get_obs_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.get_sim_data_files"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.get_sim_data_files()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.load_param_data"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.load_param_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.load_sim_data"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.load_sim_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.run"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.set_sim_data"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.set_sim_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.write_params_to_txt"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.write_params_to_txt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.write_to_table"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.write_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.callback"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.callback</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.ctrl_data"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.ctrl_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.ctrl_name"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.ctrl_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.estimated_params"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.estimated_params</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.estimated_params_CV"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.estimated_params_CV</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.inv_obs_weight"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.inv_obs_weight</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.num_ctrl"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.num_ctrl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.num_obs"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.num_obs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.num_params"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.num_params</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.num_samples"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.num_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.num_steps"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.num_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.obs_data"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.obs_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.obs_data_file"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.obs_data_file</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.obs_names"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.obs_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.param_data"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.param_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.param_data_file"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.param_data_file</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.param_data_prev"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.param_data_prev</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.param_max"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.param_max</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.param_min"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.param_min</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.param_names"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.param_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.sigma_max"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.sigma_max</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.sigma_min"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.sigma_min</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.sigma_tol"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.sigma_tol</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.sim_data"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.sim_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.sim_data_dir"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.sim_data_dir</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.sim_data_file_ext"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.sim_data_file_ext</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.sim_data_files"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.sim_data_files</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.dynamic_systems.IODynamicSystem.sim_name"><code class="docutils literal notranslate"><span class="pre">IODynamicSystem.sim_name</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-grainlearning.iterative_bayesian_filter"><code class="docutils literal notranslate"><span class="pre">Iterative</span> <span class="pre">Bayesian</span> <span class="pre">Filter</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter"><code class="docutils literal notranslate"><span class="pre">IterativeBayesianFilter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.from_dict"><code class="docutils literal notranslate"><span class="pre">IterativeBayesianFilter.from_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.initialize"><code class="docutils literal notranslate"><span class="pre">IterativeBayesianFilter.initialize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.run_inference"><code class="docutils literal notranslate"><span class="pre">IterativeBayesianFilter.run_inference()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.run_sampling"><code class="docutils literal notranslate"><span class="pre">IterativeBayesianFilter.run_sampling()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.solve"><code class="docutils literal notranslate"><span class="pre">IterativeBayesianFilter.solve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.ess_tol"><code class="docutils literal notranslate"><span class="pre">IterativeBayesianFilter.ess_tol</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.inference"><code class="docutils literal notranslate"><span class="pre">IterativeBayesianFilter.inference</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.initial_sampling"><code class="docutils literal notranslate"><span class="pre">IterativeBayesianFilter.initial_sampling</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.param_data_list"><code class="docutils literal notranslate"><span class="pre">IterativeBayesianFilter.param_data_list</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.posterior_ibf"><code class="docutils literal notranslate"><span class="pre">IterativeBayesianFilter.posterior_ibf</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.sampling"><code class="docutils literal notranslate"><span class="pre">IterativeBayesianFilter.sampling</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.sigma_list"><code class="docutils literal notranslate"><span class="pre">IterativeBayesianFilter.sigma_list</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-grainlearning.inference"><code class="docutils literal notranslate"><span class="pre">Inference</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#grainlearning.inference.SMC"><code class="docutils literal notranslate"><span class="pre">SMC</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.inference.SMC.compute_effective_sample_size"><code class="docutils literal notranslate"><span class="pre">SMC.compute_effective_sample_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.inference.SMC.data_assimilation_loop"><code class="docutils literal notranslate"><span class="pre">SMC.data_assimilation_loop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.inference.SMC.from_dict"><code class="docutils literal notranslate"><span class="pre">SMC.from_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.inference.SMC.get_covariance_matrices"><code class="docutils literal notranslate"><span class="pre">SMC.get_covariance_matrices()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.inference.SMC.get_likelihoods"><code class="docutils literal notranslate"><span class="pre">SMC.get_likelihoods()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.inference.SMC.get_posterior_at_time"><code class="docutils literal notranslate"><span class="pre">SMC.get_posterior_at_time()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.inference.SMC.get_posteriors"><code class="docutils literal notranslate"><span class="pre">SMC.get_posteriors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.inference.SMC.cov_matrices"><code class="docutils literal notranslate"><span class="pre">SMC.cov_matrices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.inference.SMC.ess"><code class="docutils literal notranslate"><span class="pre">SMC.ess</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.inference.SMC.ess_target"><code class="docutils literal notranslate"><span class="pre">SMC.ess_target</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.inference.SMC.likelihoods"><code class="docutils literal notranslate"><span class="pre">SMC.likelihoods</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.inference.SMC.posteriors"><code class="docutils literal notranslate"><span class="pre">SMC.posteriors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.inference.SMC.scale_cov_with_max"><code class="docutils literal notranslate"><span class="pre">SMC.scale_cov_with_max</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-grainlearning.sampling"><code class="docutils literal notranslate"><span class="pre">Sampling</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#grainlearning.sampling.GaussianMixtureModel"><code class="docutils literal notranslate"><span class="pre">GaussianMixtureModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.sampling.GaussianMixtureModel.expand_weighted_parameters"><code class="docutils literal notranslate"><span class="pre">GaussianMixtureModel.expand_weighted_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.sampling.GaussianMixtureModel.from_dict"><code class="docutils literal notranslate"><span class="pre">GaussianMixtureModel.from_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.sampling.GaussianMixtureModel.regenerate_params"><code class="docutils literal notranslate"><span class="pre">GaussianMixtureModel.regenerate_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#grainlearning.sampling.GaussianMixtureModel.regenerate_params_with_gmm"><code class="docutils literal notranslate"><span class="pre">GaussianMixtureModel.regenerate_params_with_gmm()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#grainlearning.sampling.generate_params_qmc"><code class="docutils literal notranslate"><span class="pre">generate_params_qmc()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GrainLearning</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Python API</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="python-api">
<h1>Python API<a class="headerlink" href="#python-api" title="Permalink to this heading"></a></h1>
<section id="module-grainlearning.bayesian_calibration">
<span id="calibration-toolbox"></span><h2><code class="docutils literal notranslate"><span class="pre">Calibration</span> <span class="pre">toolbox</span></code><a class="headerlink" href="#module-grainlearning.bayesian_calibration" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="grainlearning.bayesian_calibration.BayesianCalibration">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BayesianCalibration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curr_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.bayesian_calibration.BayesianCalibration" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This is the Bayesian calibration class.</p>
<p>A Bayesian calibration class consists of the inference class and the (re)sampling class.
For instance, in GrainLearning, we have a calibration method called “iterative Bayesian filter”
which consists of “sequential Monte Carlo” for model parameter estimation
and “variational Gaussian mixture” for resampling.</p>
<p>There are two ways of initializing a calibration toolbox class.</p>
<p>Method 1 - dictionary style (recommended)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">system_cls</span> <span class="o">=</span> <span class="n">BayesianCalibration</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;num_iter&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
        <span class="s2">&quot;system&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;system_type&quot;</span><span class="p">:</span> <span class="n">DynamicSystem</span><span class="p">,</span>
            <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>
            <span class="s2">&quot;param_names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
            <span class="s2">&quot;param_min&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;param_max&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="s2">&quot;num_samples&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s2">&quot;obs_data&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span>
            <span class="s2">&quot;ctrl_data&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
            <span class="s2">&quot;callback&quot;</span><span class="p">:</span> <span class="n">run_sim</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;calibration&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;inference&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;ess_target&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">},</span>
            <span class="s2">&quot;sampling&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;max_num_components&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="p">},</span>
        <span class="s2">&quot;save_fig&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>or</p>
<p>Method 2 - class style</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">system_cls</span> <span class="o">=</span> <span class="n">BayesianCalibration</span><span class="p">(</span>
    <span class="n">num_iter</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">DynamicSystem</span><span class="p">(</span><span class="o">...</span><span class="p">),</span>
    <span class="n">calibration</span> <span class="o">=</span> <span class="n">IterativeBayesianFilter</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="n">save_fig</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a>]) – A <a class="reference external" href="https://en.wikipedia.org/wiki/Particle_filter#Approximate_Bayesian_computation_models">dynamic system</a> whose observables and hidden states evolve dynamically over “time”</p></li>
<li><p><strong>calibration</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter" title="grainlearning.iterative_bayesian_filter.IterativeBayesianFilter"><code class="xref py py-class docutils literal notranslate"><span class="pre">IterativeBayesianFilter</span></code></a>]) – An iterative Bayesian Filter that iteratively sample the parameter space</p></li>
<li><p><strong>num_iter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of iteration steps</p></li>
<li><p><strong>curr_iter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Current iteration step</p></li>
<li><p><strong>save_fig</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Flag for skipping (-1), showing (0), or saving (1) the figures</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.bayesian_calibration.BayesianCalibration.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.bayesian_calibration.BayesianCalibration.from_dict" title="Permalink to this definition"></a></dt>
<dd><p>An alternative constructor to allow choosing a system type (e.g., dynamic system or IO dynamic system)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>) – a dictionary containing the keys and values to construct a BayesianCalibration object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a BayesianCalibration object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.bayesian_calibration.BayesianCalibration.get_most_prob_params">
<span class="sig-name descname"><span class="pre">get_most_prob_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.bayesian_calibration.BayesianCalibration.get_most_prob_params" title="Permalink to this definition"></a></dt>
<dd><p>Return the most probable set of parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Estimated parameter values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.bayesian_calibration.BayesianCalibration.load_and_process">
<span class="sig-name descname"><span class="pre">load_and_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.bayesian_calibration.BayesianCalibration.load_and_process" title="Permalink to this definition"></a></dt>
<dd><p>Load existing simulation data and compute the posterior distribution using an assumed sigma</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sigma</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – assumed uncertainty coefficient, defaults to 0.1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.bayesian_calibration.BayesianCalibration.load_and_run_one_iteration">
<span class="sig-name descname"><span class="pre">load_and_run_one_iteration</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.bayesian_calibration.BayesianCalibration.load_and_run_one_iteration" title="Permalink to this definition"></a></dt>
<dd><p>Load existing simulation data and run Bayesian calibration for one iteration
Note the maximum uncertainty sigma_max is solved to reach a certain effective sample size ess_target,
unlike being assumed as an input for <cite>load_and_process(…)</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.bayesian_calibration.BayesianCalibration.load_system">
<span class="sig-name descname"><span class="pre">load_system</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.bayesian_calibration.BayesianCalibration.load_system" title="Permalink to this definition"></a></dt>
<dd><p>Load existing simulation data from disk into the dynamic system</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.bayesian_calibration.BayesianCalibration.plot_uq_in_time">
<span class="sig-name descname"><span class="pre">plot_uq_in_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.bayesian_calibration.BayesianCalibration.plot_uq_in_time" title="Permalink to this definition"></a></dt>
<dd><p>Plot the evolution of uncertainty moments and distribution over time</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.bayesian_calibration.BayesianCalibration.resample">
<span class="sig-name descname"><span class="pre">resample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.bayesian_calibration.BayesianCalibration.resample" title="Permalink to this definition"></a></dt>
<dd><p>Learn and resample from a proposal distribution
todo this should be refactored</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Combinations of resampled parameter values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.bayesian_calibration.BayesianCalibration.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.bayesian_calibration.BayesianCalibration.run" title="Permalink to this definition"></a></dt>
<dd><p>This is the main calibration loop which does the following steps
1. First iteration of Bayesian calibration starts with a Halton sequence
2. Iterations continue by resampling the parameter space until certain criteria are met.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.bayesian_calibration.BayesianCalibration.run_one_iteration">
<span class="sig-name descname"><span class="pre">run_one_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.bayesian_calibration.BayesianCalibration.run_one_iteration" title="Permalink to this definition"></a></dt>
<dd><p>Run Bayesian calibration for one iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – iteration step, defaults to -1</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.bayesian_calibration.BayesianCalibration.calibration">
<span class="sig-name descname"><span class="pre">calibration</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code><span class="pre">[</span><a class="reference internal" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter" title="grainlearning.iterative_bayesian_filter.IterativeBayesianFilter"><code class="xref py py-class docutils literal notranslate"><span class="pre">IterativeBayesianFilter</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#grainlearning.bayesian_calibration.BayesianCalibration.calibration" title="Permalink to this definition"></a></dt>
<dd><p>Calibration method (e.g, Iterative Bayesian Filter)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.bayesian_calibration.BayesianCalibration.curr_iter">
<span class="sig-name descname"><span class="pre">curr_iter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#grainlearning.bayesian_calibration.BayesianCalibration.curr_iter" title="Permalink to this definition"></a></dt>
<dd><p>Current calibration step</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.bayesian_calibration.BayesianCalibration.num_iter">
<span class="sig-name descname"><span class="pre">num_iter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#grainlearning.bayesian_calibration.BayesianCalibration.num_iter" title="Permalink to this definition"></a></dt>
<dd><p>Number of iterations</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.bayesian_calibration.BayesianCalibration.save_fig">
<span class="sig-name descname"><span class="pre">save_fig</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-1</span></em><a class="headerlink" href="#grainlearning.bayesian_calibration.BayesianCalibration.save_fig" title="Permalink to this definition"></a></dt>
<dd><p>Flag to save figures</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.bayesian_calibration.BayesianCalibration.system">
<span class="sig-name descname"><span class="pre">system</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code><span class="pre">[</span><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#grainlearning.bayesian_calibration.BayesianCalibration.system" title="Permalink to this definition"></a></dt>
<dd><p>Dynamic system whose parameters or hidden states are being inferred</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-grainlearning.dynamic_systems">
<span id="dynamic-systems"></span><h2><code class="docutils literal notranslate"><span class="pre">Dynamic</span> <span class="pre">systems</span></code><a class="headerlink" href="#module-grainlearning.dynamic_systems" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DynamicSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctrl_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctrl_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_obs_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This is the dynamical system class.</p>
<p>A dynamical system (also known as a state-space system) describes the time evolution of the system’s (hidden) state
and observation using the following equations:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}x_t &amp; = f(x_{t−1}) + q_{t−1}\\y_t &amp; = h(x_t) + r_t\end{aligned}\end{align} \]</div>
<p>where
<span class="math notranslate nohighlight">\(x_t\)</span> is the hidden state,
<span class="math notranslate nohighlight">\(y_t\)</span> is the observation, both represented as random processes,
<span class="math notranslate nohighlight">\(f\)</span> is the state transition function,
<span class="math notranslate nohighlight">\(h\)</span> is the observation function,
<span class="math notranslate nohighlight">\(q_{t−1}\)</span> is the process noise, and <span class="math notranslate nohighlight">\(r_t\)</span> is the observation noise.</p>
<p>In the context of Bayesian parameter estimation, <span class="math notranslate nohighlight">\(f\)</span> is the model that describe the physical process
and <span class="math notranslate nohighlight">\(h\)</span> is the model that describe the relationship between the hidden state and observation.
In the simplest case, <span class="math notranslate nohighlight">\(h\)</span> is an identity matrix which indicate the one-to-one relationship
between <span class="math notranslate nohighlight">\(x_t\)</span> and <span class="math notranslate nohighlight">\(y_t\)</span>.</p>
<p>Therefore, the <a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a> class is used to encapsulate the observation data and the simulation data,
which require specifying the number of samples, the lower and upper bound of the parameters, and the callback function
that runs the forward predictions.</p>
<p>There are two ways of initializing the class.</p>
<p>Method 1 - dictionary style</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">system_cls</span> <span class="o">=</span> <span class="n">DynamicSystem</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;param_names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
        <span class="s2">&quot;param_min&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;param_max&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
        <span class="s2">&quot;num_samples&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
        <span class="s2">&quot;obs_data&quot;</span><span class="p">:</span> <span class="n">y_obs</span><span class="p">,</span>
        <span class="s2">&quot;ctrl_data&quot;</span><span class="p">:</span> <span class="n">y_ctrl</span><span class="p">,</span>
        <span class="s2">&quot;callback&quot;</span><span class="p">:</span> <span class="n">run_sim</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>or</p>
<p>Method 2 - class style</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">system_cls</span> <span class="o">=</span> <span class="n">DynamicSystem</span><span class="p">(</span>
    <span class="n">param_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
    <span class="n">param_min</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">param_max</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="n">num_samples</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
    <span class="n">obs_data</span> <span class="o">=</span> <span class="n">y_obs</span><span class="p">,</span>
    <span class="n">ctrl_data</span> <span class="o">=</span> <span class="n">y_ctrl</span><span class="p">,</span>
    <span class="n">callback</span> <span class="o">=</span> <span class="n">run_sim</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You can pass the simulation data to the class using the <a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem.set_sim_data" title="grainlearning.dynamic_systems.DynamicSystem.set_sim_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DynamicSystem.set_sim_data()</span></code></a> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">system_cls</span><span class="o">.</span><span class="n">set_sim_data</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>The simulation data is a numpy array of shape (num_samples, num_obs, num_steps).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – observation or reference data</p></li>
<li><p><strong>num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Sample size</p></li>
<li><p><strong>param_min</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – List of parameter lower bounds</p></li>
<li><p><strong>param_max</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – List of parameter Upper bounds</p></li>
<li><p><strong>callback</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>]) – Callback function, defaults to None</p></li>
<li><p><strong>ctrl_data</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – control data (e.g, time), defaults to None, optional</p></li>
<li><p><strong>obs_names</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Column names of the observation data, defaults to None, optional</p></li>
<li><p><strong>ctrl_name</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Column name of the control data, defaults to None, optional</p></li>
<li><p><strong>inv_obs_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Inverse of the observation weight, defaults to None, optional</p></li>
<li><p><strong>param_data</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – Parameter data, defaults to None, optional</p></li>
<li><p><strong>param_names</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Parameter names, defaults to None, optional</p></li>
<li><p><strong>sim_data</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – Simulation data, defaults to None, optional</p></li>
<li><p><strong>sigma_max</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Maximum uncertainty, defaults to 1.0e6, optional</p></li>
<li><p><strong>sigma_tol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Tolerance of the estimated uncertainty, defaults to 1.0e-3, optional</p></li>
<li><p><strong>sim_name</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Name of the simulation, defaults to ‘sim’, optional</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.compute_estimated_params">
<span class="sig-name descname"><span class="pre">compute_estimated_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">posteriors</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.compute_estimated_params" title="Permalink to this definition"></a></dt>
<dd><p>Compute the estimated means and uncertainties for the parameters.</p>
<p>This function is vectorized for all time steps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>posteriors</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>) – Posterior distribution of shape (num_steps, num_samples)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.compute_inv_normalized_sigma">
<span class="sig-name descname"><span class="pre">compute_inv_normalized_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.compute_inv_normalized_sigma" title="Permalink to this definition"></a></dt>
<dd><p>Compute the inverse of the matrix that apply different weights on the observables</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.from_dict" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the class using a dictionary style</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Dictionary object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DynamicSystem: DynamicSystem object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.get_inv_normalized_sigma">
<span class="sig-name descname"><span class="pre">get_inv_normalized_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.get_inv_normalized_sigma" title="Permalink to this definition"></a></dt>
<dd><p>Get the inverse of the matrix that apply different weights on the observables</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.get_sim_data_files">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_sim_data_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curr_iter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.get_sim_data_files" title="Permalink to this definition"></a></dt>
<dd><p>Virtual function to get simulation data files from disk</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.load_param_data">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_param_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curr_iter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.load_param_data" title="Permalink to this definition"></a></dt>
<dd><p>Virtual function to load param data from disk</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.load_sim_data">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_sim_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.load_sim_data" title="Permalink to this definition"></a></dt>
<dd><p>Virtual function to load simulation data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.run" title="Permalink to this definition"></a></dt>
<dd><p>Run the callback function</p>
<p>TODO design a better wrapper to avoid kwargs?
:type kwargs: 
:param kwargs: keyword arguments to pass to the callback function</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.set_sim_data">
<span class="sig-name descname"><span class="pre">set_sim_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.set_sim_data" title="Permalink to this definition"></a></dt>
<dd><p>Set the simulation data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – simulation data of shape (num_samples, num_obs, num_steps)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.write_to_table">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.write_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Virtual function to write parameters into a text file</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.callback">
<span class="sig-name descname"><span class="pre">callback</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.callback" title="Permalink to this definition"></a></dt>
<dd><p>Callback function to run the forward predictions</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.ctrl_data">
<span class="sig-name descname"><span class="pre">ctrl_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.ctrl_data" title="Permalink to this definition"></a></dt>
<dd><p>Control dataset (num_ctrl, num_steps)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.ctrl_name">
<span class="sig-name descname"><span class="pre">ctrl_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.ctrl_name" title="Permalink to this definition"></a></dt>
<dd><p>Observation control (e.g., time)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.estimated_params">
<span class="sig-name descname"><span class="pre">estimated_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.estimated_params" title="Permalink to this definition"></a></dt>
<dd><p>Estimated parameter as the first moment of the distribution (<span class="math notranslate nohighlight">\(x_\mu = \sum_i w_i * x_i\)</span>)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.estimated_params_CV">
<span class="sig-name descname"><span class="pre">estimated_params_CV</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.estimated_params_CV" title="Permalink to this definition"></a></dt>
<dd><p>Parameter uncertainty as the second moment of the distribution (<span class="math notranslate nohighlight">\(x_\sigma = \sum_i w_i \cdot (x_i - x_\mu)^2 / x_\mu\)</span>)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.inv_obs_weight">
<span class="sig-name descname"><span class="pre">inv_obs_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.inv_obs_weight" title="Permalink to this definition"></a></dt>
<dd><p>Inverse of the observation weight</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.num_ctrl">
<span class="sig-name descname"><span class="pre">num_ctrl</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.num_ctrl" title="Permalink to this definition"></a></dt>
<dd><p>Number of control data (identical between simulation and observation)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.num_obs">
<span class="sig-name descname"><span class="pre">num_obs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.num_obs" title="Permalink to this definition"></a></dt>
<dd><p>Number of observations in the dataset</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.num_params">
<span class="sig-name descname"><span class="pre">num_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.num_params" title="Permalink to this definition"></a></dt>
<dd><p>Number of unknown parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.num_samples">
<span class="sig-name descname"><span class="pre">num_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.num_samples" title="Permalink to this definition"></a></dt>
<dd><p>Number of samples (usually specified by user)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.num_steps">
<span class="sig-name descname"><span class="pre">num_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.num_steps" title="Permalink to this definition"></a></dt>
<dd><p>Number of steps or sequence size in the dataset</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.obs_data">
<span class="sig-name descname"><span class="pre">obs_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.obs_data" title="Permalink to this definition"></a></dt>
<dd><p>Observation (or reference) data of shape (num_obs, num_steps)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.obs_names">
<span class="sig-name descname"><span class="pre">obs_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.obs_names" title="Permalink to this definition"></a></dt>
<dd><p>Observation keys</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.param_data">
<span class="sig-name descname"><span class="pre">param_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.param_data" title="Permalink to this definition"></a></dt>
<dd><p>Parameter data of shape (num_samples, num_params)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.param_data_prev">
<span class="sig-name descname"><span class="pre">param_data_prev</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.param_data_prev" title="Permalink to this definition"></a></dt>
<dd><p>Parameter data of previous iteration</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.param_max">
<span class="sig-name descname"><span class="pre">param_max</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.param_max" title="Permalink to this definition"></a></dt>
<dd><p>Upper bound of the parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.param_min">
<span class="sig-name descname"><span class="pre">param_min</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.param_min" title="Permalink to this definition"></a></dt>
<dd><p>Lower bound of the parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.param_names">
<span class="sig-name descname"><span class="pre">param_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.param_names" title="Permalink to this definition"></a></dt>
<dd><p>Names of the parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.sigma_max">
<span class="sig-name descname"><span class="pre">sigma_max</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1000000.0</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.sigma_max" title="Permalink to this definition"></a></dt>
<dd><p>Maximum value of the uncertainty</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.sigma_min">
<span class="sig-name descname"><span class="pre">sigma_min</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.sigma_min" title="Permalink to this definition"></a></dt>
<dd><p>Minimum value of the uncertainty</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.sigma_tol">
<span class="sig-name descname"><span class="pre">sigma_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.001</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.sigma_tol" title="Permalink to this definition"></a></dt>
<dd><p>Sigma tolerance</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.sim_data">
<span class="sig-name descname"><span class="pre">sim_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.sim_data" title="Permalink to this definition"></a></dt>
<dd><p>Simulation data of shape (num_samples, num_obs, num_steps)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.DynamicSystem.sim_name">
<span class="sig-name descname"><span class="pre">sim_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sim'</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.DynamicSystem.sim_name" title="Permalink to this definition"></a></dt>
<dd><p>Name of the simulation (e.g., sim)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IODynamicSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_data_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_data_file_ext</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_data_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctrl_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_data_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctrl_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_obs_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a></p>
<p>This is the I/O dynamic system class derived from the dynamic system class.
Extra functionalities are added to handle I/O operations.</p>
<p>There are two ways of initializing the class.</p>
<p>Method 1 - dictionary style</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">system_cls</span> <span class="o">=</span> <span class="n">IODynamicSystem</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;system_type&quot;</span><span class="p">:</span> <span class="n">IODynamicSystem</span><span class="p">,</span>
        <span class="s2">&quot;param_min&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;param_max&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
        <span class="s2">&quot;param_names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span>
        <span class="s2">&quot;num_samples&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
        <span class="s2">&quot;obs_data_file&quot;</span><span class="p">:</span> <span class="s1">&#39;obs_data.txt&#39;</span><span class="p">,</span>
        <span class="s2">&quot;obs_names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;y_obs&#39;</span><span class="p">],</span>
        <span class="s2">&quot;ctrl_name&quot;</span><span class="p">:</span> <span class="s1">&#39;y_ctrl</span>
        <span class="s2">&quot;sim_name&quot;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
        <span class="s2">&quot;sim_data_file_ext&quot;</span><span class="p">:</span> <span class="s1">&#39;.txt&#39;</span><span class="p">,</span>
        <span class="s2">&quot;callback&quot;</span><span class="p">:</span> <span class="n">run_sim</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>or</p>
<p>Method 2 - class style</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">system_cls</span> <span class="o">=</span> <span class="n">IODynamicSystem</span><span class="p">(</span>
        <span class="n">param_min</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">param_max</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
        <span class="n">param_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span>
        <span class="n">num_samples</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
        <span class="n">obs_data_file</span> <span class="o">=</span> <span class="s1">&#39;obs_data.txt&#39;</span><span class="p">,</span>
        <span class="n">obs_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;y_obs&#39;</span><span class="p">],</span>
        <span class="n">ctrl_name</span> <span class="o">=</span> <span class="s1">&#39;y_ctrl&#39;</span><span class="p">,</span>
        <span class="n">sim_name</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
        <span class="n">sim_data_file_ext</span> <span class="o">=</span> <span class="s1">&#39;.txt&#39;</span><span class="p">,</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="n">run_sim</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_min</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – List of parameter lower bounds</p></li>
<li><p><strong>param_max</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – List of parameter Upper bounds</p></li>
<li><p><strong>param_names</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Parameter names, defaults to None</p></li>
<li><p><strong>num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Sample size</p></li>
<li><p><strong>obs_data_file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Observation data file, defaults to None</p></li>
<li><p><strong>obs_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Column names of the observation data, defaults to None</p></li>
<li><p><strong>ctrl_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Column name of the control data, defaults to None</p></li>
<li><p><strong>sim_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Name of the simulation, defaults to ‘sim’</p></li>
<li><p><strong>sim_data_dir</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Simulation data directory, defaults to ‘./sim_data’</p></li>
<li><p><strong>sim_data_file_ext</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Simulation data file extension, defaults to ‘.npy’</p></li>
<li><p><strong>callback</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>]) – Callback function, defaults to None</p></li>
<li><p><strong>param_data_file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Parameter data file, defaults to None, optional</p></li>
<li><p><strong>obs_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – observation or reference data, optional</p></li>
<li><p><strong>ctrl_data</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – Control data (e.g, time), defaults to None, optional</p></li>
<li><p><strong>inv_obs_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Inverse of the observation weight, defaults to None, optional</p></li>
<li><p><strong>param_data</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – Parameter data, defaults to None, optional</p></li>
<li><p><strong>sim_data</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – Simulation data, defaults to None, optional</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.compute_estimated_params">
<span class="sig-name descname"><span class="pre">compute_estimated_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">posteriors</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.compute_estimated_params" title="Permalink to this definition"></a></dt>
<dd><p>Compute the estimated means and uncertainties for the parameters.</p>
<p>This function is vectorized for all time steps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>posteriors</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>) – Posterior distribution of shape (num_steps, num_samples)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.compute_inv_normalized_sigma">
<span class="sig-name descname"><span class="pre">compute_inv_normalized_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.compute_inv_normalized_sigma" title="Permalink to this definition"></a></dt>
<dd><p>Compute the inverse of the matrix that apply different weights on the observables</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.from_dict" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the class using a dictionary style</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Dictionary object</p>
</dd>
<dt class="field-even">Return IODynamicSystem<span class="colon">:</span></dt>
<dd class="field-even"><p>IODynamicSystem object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.get_inv_normalized_sigma">
<span class="sig-name descname"><span class="pre">get_inv_normalized_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.get_inv_normalized_sigma" title="Permalink to this definition"></a></dt>
<dd><p>Get the inverse of the matrix that apply different weights on the observables</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.get_obs_data">
<span class="sig-name descname"><span class="pre">get_obs_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.get_obs_data" title="Permalink to this definition"></a></dt>
<dd><p>Get the observation data from the observation data file.</p>
<p>Separate the control data from the observation data if the name of control variable is given.
Otherwise, the observation data is the entire data in the observation data file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.get_sim_data_files">
<span class="sig-name descname"><span class="pre">get_sim_data_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curr_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.get_sim_data_files" title="Permalink to this definition"></a></dt>
<dd><p>Get the simulation data files from the simulation data directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>curr_iter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Current iteration number, default to 0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.load_param_data">
<span class="sig-name descname"><span class="pre">load_param_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curr_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.load_param_data" title="Permalink to this definition"></a></dt>
<dd><p>Load parameter data from a table written in a text file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>curr_iter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Current iteration number, default to 0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.load_sim_data">
<span class="sig-name descname"><span class="pre">load_sim_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.load_sim_data" title="Permalink to this definition"></a></dt>
<dd><p>Load the simulation data from the simulation data files.</p>
<p>The function does the following:
1. Load simulation data into an IO dynamic system object
2. Check if parameter values read from the table matches those used to creat the simulation data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.run" title="Permalink to this definition"></a></dt>
<dd><p>Run the callback function</p>
<p>TODO design a better wrapper to avoid kwargs?
:type kwargs: 
:param kwargs: keyword arguments to pass to the callback function</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.set_sim_data">
<span class="sig-name descname"><span class="pre">set_sim_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.set_sim_data" title="Permalink to this definition"></a></dt>
<dd><p>Set the simulation data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – simulation data of shape (num_samples, num_obs, num_steps)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.write_params_to_txt">
<span class="sig-name descname"><span class="pre">write_params_to_txt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curr_iter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.write_params_to_txt" title="Permalink to this definition"></a></dt>
<dd><p>Write the parameter data into a text file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>curr_iter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Current iteration number, default to 0.</p>
</dd>
<dt class="field-even">Return param_data_file<span class="colon">:</span></dt>
<dd class="field-even"><p>The name of the parameter data file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.write_to_table">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.write_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Virtual function to write parameters into a text file</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.callback">
<span class="sig-name descname"><span class="pre">callback</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.callback" title="Permalink to this definition"></a></dt>
<dd><p>Callback function to run the forward predictions</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.ctrl_data">
<span class="sig-name descname"><span class="pre">ctrl_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.ctrl_data" title="Permalink to this definition"></a></dt>
<dd><p>Control dataset (num_ctrl, num_steps)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.ctrl_name">
<span class="sig-name descname"><span class="pre">ctrl_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.ctrl_name" title="Permalink to this definition"></a></dt>
<dd><p>Observation control (e.g., time)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.estimated_params">
<span class="sig-name descname"><span class="pre">estimated_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.estimated_params" title="Permalink to this definition"></a></dt>
<dd><p>Estimated parameter as the first moment of the distribution (<span class="math notranslate nohighlight">\(x_\mu = \sum_i w_i * x_i\)</span>)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.estimated_params_CV">
<span class="sig-name descname"><span class="pre">estimated_params_CV</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.estimated_params_CV" title="Permalink to this definition"></a></dt>
<dd><p>Parameter uncertainty as the second moment of the distribution (<span class="math notranslate nohighlight">\(x_\sigma = \sum_i w_i \cdot (x_i - x_\mu)^2 / x_\mu\)</span>)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.inv_obs_weight">
<span class="sig-name descname"><span class="pre">inv_obs_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.inv_obs_weight" title="Permalink to this definition"></a></dt>
<dd><p>Inverse of the observation weight</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.num_ctrl">
<span class="sig-name descname"><span class="pre">num_ctrl</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.num_ctrl" title="Permalink to this definition"></a></dt>
<dd><p>Number of control data (identical between simulation and observation)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.num_obs">
<span class="sig-name descname"><span class="pre">num_obs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.num_obs" title="Permalink to this definition"></a></dt>
<dd><p>Number of observations in the dataset</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.num_params">
<span class="sig-name descname"><span class="pre">num_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.num_params" title="Permalink to this definition"></a></dt>
<dd><p>Number of unknown parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.num_samples">
<span class="sig-name descname"><span class="pre">num_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.num_samples" title="Permalink to this definition"></a></dt>
<dd><p>Number of samples (usually specified by user)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.num_steps">
<span class="sig-name descname"><span class="pre">num_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.num_steps" title="Permalink to this definition"></a></dt>
<dd><p>Number of steps or sequence size in the dataset</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.obs_data">
<span class="sig-name descname"><span class="pre">obs_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.obs_data" title="Permalink to this definition"></a></dt>
<dd><p>Observation (or reference) data of shape (num_obs, num_steps)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.obs_data_file">
<span class="sig-name descname"><span class="pre">obs_data_file</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.obs_data_file" title="Permalink to this definition"></a></dt>
<dd><p>Name of the observation data file</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.obs_names">
<span class="sig-name descname"><span class="pre">obs_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.obs_names" title="Permalink to this definition"></a></dt>
<dd><p>Observation keys</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.param_data">
<span class="sig-name descname"><span class="pre">param_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.param_data" title="Permalink to this definition"></a></dt>
<dd><p>Parameter data of shape (num_samples, num_params)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.param_data_file">
<span class="sig-name descname"><span class="pre">param_data_file</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.param_data_file" title="Permalink to this definition"></a></dt>
<dd><p>Name of the parameter data file</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.param_data_prev">
<span class="sig-name descname"><span class="pre">param_data_prev</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.param_data_prev" title="Permalink to this definition"></a></dt>
<dd><p>Parameter data of previous iteration</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.param_max">
<span class="sig-name descname"><span class="pre">param_max</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.param_max" title="Permalink to this definition"></a></dt>
<dd><p>Upper bound of the parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.param_min">
<span class="sig-name descname"><span class="pre">param_min</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.param_min" title="Permalink to this definition"></a></dt>
<dd><p>Lower bound of the parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.param_names">
<span class="sig-name descname"><span class="pre">param_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.param_names" title="Permalink to this definition"></a></dt>
<dd><p>Names of the parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.sigma_max">
<span class="sig-name descname"><span class="pre">sigma_max</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1000000.0</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.sigma_max" title="Permalink to this definition"></a></dt>
<dd><p>Maximum value of the uncertainty</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.sigma_min">
<span class="sig-name descname"><span class="pre">sigma_min</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.sigma_min" title="Permalink to this definition"></a></dt>
<dd><p>Minimum value of the uncertainty</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.sigma_tol">
<span class="sig-name descname"><span class="pre">sigma_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.001</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.sigma_tol" title="Permalink to this definition"></a></dt>
<dd><p>Sigma tolerance</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.sim_data">
<span class="sig-name descname"><span class="pre">sim_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.sim_data" title="Permalink to this definition"></a></dt>
<dd><p>Simulation data of shape (num_samples, num_obs, num_steps)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.sim_data_dir">
<span class="sig-name descname"><span class="pre">sim_data_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'./sim_data'</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.sim_data_dir" title="Permalink to this definition"></a></dt>
<dd><p>Name of the directory where simulation data is stored</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.sim_data_file_ext">
<span class="sig-name descname"><span class="pre">sim_data_file_ext</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'.npy'</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.sim_data_file_ext" title="Permalink to this definition"></a></dt>
<dd><p>Extension of simulation data files</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.sim_data_files">
<span class="sig-name descname"><span class="pre">sim_data_files</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.sim_data_files" title="Permalink to this definition"></a></dt>
<dd><p>Simulation data files (num_samples)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.dynamic_systems.IODynamicSystem.sim_name">
<span class="sig-name descname"><span class="pre">sim_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sim'</span></em><a class="headerlink" href="#grainlearning.dynamic_systems.IODynamicSystem.sim_name" title="Permalink to this definition"></a></dt>
<dd><p>Name of the simulation (e.g., sim)</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-grainlearning.iterative_bayesian_filter">
<span id="iterative-bayesian-filter"></span><h2><code class="docutils literal notranslate"><span class="pre">Iterative</span> <span class="pre">Bayesian</span> <span class="pre">Filter</span></code><a class="headerlink" href="#module-grainlearning.iterative_bayesian_filter" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="grainlearning.iterative_bayesian_filter.IterativeBayesianFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IterativeBayesianFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ess_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'halton'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proposal_ibf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proposal_data_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Iterative Bayesian Filter class.</p>
<p>There are two ways of initializing the class.</p>
<p>Method 1 - dictionary style</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ibf_cls</span> <span class="o">=</span> <span class="n">IterativeBayesianFilter</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;inference&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;ess_target&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
            <span class="s2">&quot;scale_cov_with_max&quot;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">},</span>
        <span class="s2">&quot;sampling&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;max_num_components&quot;</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>or</p>
<p>Method 2 - class style</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">system_cls</span> <span class="o">=</span> <span class="n">IterativeBayesianFilter</span><span class="p">(</span>
        <span class="n">inference</span> <span class="o">=</span> <span class="n">SMC</span><span class="p">(</span><span class="o">...</span><span class="p">),</span>
        <span class="n">sampling</span> <span class="o">=</span> <span class="n">GaussianMixtureModel</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inference</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#grainlearning.inference.SMC" title="grainlearning.inference.SMC"><code class="xref py py-class docutils literal notranslate"><span class="pre">SMC</span></code></a>]) – Sequential Monte Carlo class (SMC)</p></li>
<li><p><strong>sampling</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#grainlearning.sampling.GaussianMixtureModel" title="grainlearning.sampling.GaussianMixtureModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianMixtureModel</span></code></a>]) – Gaussian Mixture Model class (GMM)</p></li>
<li><p><strong>initial_sampling</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – the initial sampling method, defaults to Halton</p></li>
<li><p><strong>ess_tol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Tolerance for the effective sample size to converge, defaults to 1.0e-2</p></li>
<li><p><strong>proposal_ibf</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – User defined proposal distribution for the data assimilation loop, defaults to None</p></li>
<li><p><strong>proposal_data_file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Pickle that stores the previously trained posterior distribution</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.from_dict" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the class using a dictionary style</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> (<em>dict</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.initialize" title="Permalink to this definition"></a></dt>
<dd><p>Resample the parameters using the Gaussian mixture model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a>]) – Dynamic system class</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.run_inference">
<span class="sig-name descname"><span class="pre">run_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.run_inference" title="Permalink to this definition"></a></dt>
<dd><p>Run inference (e.g, data assimilation loop) using the Sequential Monte Carlo</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a>]) – Dynamic system class</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.run_sampling">
<span class="sig-name descname"><span class="pre">run_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.run_sampling" title="Permalink to this definition"></a></dt>
<dd><p>Resample the parameters using the Gaussian mixture model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a>]) – Dynamic system class</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.solve" title="Permalink to this definition"></a></dt>
<dd><p>Run both inference and sampling for a dynamic system</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a>]) – Dynamic system class</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.ess_tol">
<span class="sig-name descname"><span class="pre">ess_tol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.01</span></em><a class="headerlink" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.ess_tol" title="Permalink to this definition"></a></dt>
<dd><p>This a tolerance to which the optimization algorithm converges.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.inference">
<span class="sig-name descname"><span class="pre">inference</span></span><a class="headerlink" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.inference" title="Permalink to this definition"></a></dt>
<dd><p>The inference class is a member variable of the particle filter which is used to generate the likelihood</p>
<p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">SMC</span></code>]</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.initial_sampling">
<span class="sig-name descname"><span class="pre">initial_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'halton'</span></em><a class="headerlink" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.initial_sampling" title="Permalink to this definition"></a></dt>
<dd><p>The non-informative distribution to draw the initial samples</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.param_data_list">
<span class="sig-name descname"><span class="pre">param_data_list</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.param_data_list" title="Permalink to this definition"></a></dt>
<dd><p>list of parameter data of shape (num_samples, num_params) from all iterations</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.posterior_ibf">
<span class="sig-name descname"><span class="pre">posterior_ibf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.posterior_ibf" title="Permalink to this definition"></a></dt>
<dd><p>this is the current proposal distribution</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.sampling">
<span class="sig-name descname"><span class="pre">sampling</span></span><a class="headerlink" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.sampling" title="Permalink to this definition"></a></dt>
<dd><p>The gaussian mixture model class is used to sample the parameters</p>
<p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianMixtureModel</span></code>]</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.sigma_list">
<span class="sig-name descname"><span class="pre">sigma_list</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#grainlearning.iterative_bayesian_filter.IterativeBayesianFilter.sigma_list" title="Permalink to this definition"></a></dt>
<dd><p>List of sigmas</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-grainlearning.inference">
<span id="inference"></span><h2><code class="docutils literal notranslate"><span class="pre">Inference</span></code><a class="headerlink" href="#module-grainlearning.inference" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="grainlearning.inference.SMC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SMC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ess_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_cov_with_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_matrices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.inference.SMC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This is the Sequential Monte Carlo class that recursively
update model states based on sequential observations using the Bayes’ theorem</p>
<p>There are two ways of initializing the class.</p>
<p>Method 1 - dictionary style</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">system_cls</span> <span class="o">=</span> <span class="n">SMC</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;ess_target&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
        <span class="s2">&quot;scale_cov_with_max&quot;</span><span class="p">:</span> <span class="kc">True</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>or</p>
<p>Method 2 - class style</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">system_cls</span> <span class="o">=</span> <span class="n">SMC</span><span class="p">(</span>
        <span class="n">ess_target</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
        <span class="n">scale_cov_with_max</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ess_target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Target effective sample size (w_0 / sum_i w_i^2) where w_0 = 1 / N_p, defaults to 0.3</p></li>
<li><p><strong>scale_cov_with_max</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – True if the covariance matrix is scaled with the maxima of the observations, defaults to True</p></li>
<li><p><strong>cov_matrices</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>]) – Covariance matrices of shape (num_steps, num_obs, num_obs), defaults to None, Optional</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.inference.SMC.compute_effective_sample_size">
<span class="sig-name descname"><span class="pre">compute_effective_sample_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.inference.SMC.compute_effective_sample_size" title="Permalink to this definition"></a></dt>
<dd><p>Compute the effective sample size</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.inference.SMC.data_assimilation_loop">
<span class="sig-name descname"><span class="pre">data_assimilation_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proposal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.inference.SMC.data_assimilation_loop" title="Permalink to this definition"></a></dt>
<dd><p>Perform data assimilation loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Uncertainty</p></li>
<li><p><strong>proposal</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – Proposal distribution from which the samples are sampled from, defaults to None, optional</p></li>
<li><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a>]) – Dynamic system class</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the objective function which converges to a user defined effective sample size</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.inference.SMC.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.inference.SMC.from_dict" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the class using a dictionary style</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – a dictionary containing the keys and values to construct an SMC object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an SMC object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.inference.SMC.get_covariance_matrices">
<span class="sig-name descname"><span class="pre">get_covariance_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.inference.SMC.get_covariance_matrices" title="Permalink to this definition"></a></dt>
<dd><p>Compute the (diagonal) covariance matrices from an uncertainty that is either
assumed by the user or updated by SMC to satisfy the target effective sample size.</p>
<p>This function is vectorized for all time steps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Uncertainty</p></li>
<li><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a>]) – Dynamic system</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Covariance matrices for all time steps</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.inference.SMC.get_likelihoods">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_likelihoods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_matrices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.inference.SMC.get_likelihoods" title="Permalink to this definition"></a></dt>
<dd><p>Compute the likelihood distributions of simulation data as a multivariate normal
centered around the observation.</p>
<p>This function is vectorized for all time steps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a>]) – Dynamic system class</p></li>
<li><p><strong>cov_matrices</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>) – Covariance matrices of shape (num_steps, num_obs, num_obs)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Likelihood matrices of shape (num_steps, num_samples) considering all time steps</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.inference.SMC.get_posterior_at_time">
<span class="sig-name descname"><span class="pre">get_posterior_at_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.inference.SMC.get_posterior_at_time" title="Permalink to this definition"></a></dt>
<dd><p>Get the posterior distribution at a certain time step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>time_step</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – input time step, defaults to -1 (the last step in time), optional</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Posterior distribution at a certain time step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.inference.SMC.get_posteriors">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_posteriors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihoods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proposal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.inference.SMC.get_posteriors" title="Permalink to this definition"></a></dt>
<dd><p>Compute the posterior distributions from the likelihood for all the time steps</p>
<p>This function is vectorized for all time steps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a>]) – Dynamic system class</p></li>
<li><p><strong>likelihoods</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>) – Likelihood matrices of shape (num_steps, num_samples)</p></li>
<li><p><strong>proposal</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>]) – Proposal distribution at the initial time step, defaults to None, optional</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Posterior matrices of shape (num_steps, num_samples) considering all time steps</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.inference.SMC.cov_matrices">
<span class="sig-name descname"><span class="pre">cov_matrices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code></em><a class="headerlink" href="#grainlearning.inference.SMC.cov_matrices" title="Permalink to this definition"></a></dt>
<dd><p>Covariance matrices of shape (num_steps, num_obs, num_obs)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.inference.SMC.ess">
<span class="sig-name descname"><span class="pre">ess</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code></em><a class="headerlink" href="#grainlearning.inference.SMC.ess" title="Permalink to this definition"></a></dt>
<dd><p>Time evolution of the effective sample size</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.inference.SMC.ess_target">
<span class="sig-name descname"><span class="pre">ess_target</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><a class="headerlink" href="#grainlearning.inference.SMC.ess_target" title="Permalink to this definition"></a></dt>
<dd><p>Target effective sample size</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.inference.SMC.likelihoods">
<span class="sig-name descname"><span class="pre">likelihoods</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code></em><a class="headerlink" href="#grainlearning.inference.SMC.likelihoods" title="Permalink to this definition"></a></dt>
<dd><p>Likelihood distributions of shape (num_steps, num_samples)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.inference.SMC.posteriors">
<span class="sig-name descname"><span class="pre">posteriors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code></em><a class="headerlink" href="#grainlearning.inference.SMC.posteriors" title="Permalink to this definition"></a></dt>
<dd><p>Posterior distributions of shape (num_steps, num_samples)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grainlearning.inference.SMC.scale_cov_with_max">
<span class="sig-name descname"><span class="pre">scale_cov_with_max</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#grainlearning.inference.SMC.scale_cov_with_max" title="Permalink to this definition"></a></dt>
<dd><p>True if the covariance matrix is scaled with the maximum of the observations, defaults to True</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-grainlearning.sampling">
<span id="sampling"></span><h2><code class="docutils literal notranslate"><span class="pre">Sampling</span></code><a class="headerlink" href="#module-grainlearning.sampling" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="grainlearning.sampling.GaussianMixtureModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GaussianMixtureModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_num_components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tied'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.sampling.GaussianMixtureModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used for the inference (sampling) of parameters using a variational Gaussian mixture model.</p>
<p>See <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.mixture.BayesianGaussianMixture.html">BayesianGaussianMixture</a>.</p>
<p>There are two ways of initializing the class.</p>
<p>Method 1 - dictionary style</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">system_cls</span> <span class="o">=</span> <span class="n">GaussianMixtureModel</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;max_num_components&quot;</span><span class="p">:</span> <span class="mi">2</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>or</p>
<p>Method 2 - class style</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">system_cls</span> <span class="o">=</span> <span class="n">GaussianMixtureModel</span><span class="p">(</span>
    <span class="n">max_num_components</span> <span class="o">=</span> <span class="mi">2</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_num_components</strong> – Maximum number of components</p></li>
<li><p><strong>prior_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Prior weight, defaults to None</p></li>
<li><p><strong>cov_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Covariance type, defaults to “tied”</p></li>
<li><p><strong>n_init</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of initial samples, defaults to 100</p></li>
<li><p><strong>tol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – tolarance, defaults to 1.0e-5</p></li>
<li><p><strong>max_iter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – maximum number of iterations, defaults to 100000</p></li>
<li><p><strong>expand_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – weighted expansions, defaults to 10</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – random generation seed, defaults to None</p></li>
<li><p><strong>slice_sampling</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – flag to use slice sampling, defaults to False</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.sampling.GaussianMixtureModel.expand_weighted_parameters">
<span class="sig-name descname"><span class="pre">expand_weighted_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">posterior_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.sampling.GaussianMixtureModel.expand_weighted_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Expand or duplicate the parameters for the gaussian mixture model. If the weights are higher, more parameters are assigned to that value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>posterior_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Posterior found by the data assimilation</p></li>
<li><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a>]) – Dynamic system class</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Expanded parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.sampling.GaussianMixtureModel.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.sampling.GaussianMixtureModel.from_dict" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the class using a dictionary style</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> (<em>dict</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.sampling.GaussianMixtureModel.regenerate_params">
<span class="sig-name descname"><span class="pre">regenerate_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">posterior_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.sampling.GaussianMixtureModel.regenerate_params" title="Permalink to this definition"></a></dt>
<dd><p>Regenerate the parameters by fitting the Gaussian Mixture model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>posterior_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Posterior found by the data assimilation</p></li>
<li><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a>]) – Dynamic system class</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Expanded parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grainlearning.sampling.GaussianMixtureModel.regenerate_params_with_gmm">
<span class="sig-name descname"><span class="pre">regenerate_params_with_gmm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">posterior_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.sampling.GaussianMixtureModel.regenerate_params_with_gmm" title="Permalink to this definition"></a></dt>
<dd><p>Regenerate the parameters by fitting the Gaussian Mixture model (for testing against the old approach)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>posterior_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Posterior found by the data assimilation</p></li>
<li><p><strong>system</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicSystem</span></code></a>]) – Dynamic system class</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Expanded parameters</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="grainlearning.sampling.generate_params_qmc">
<span class="sig-name descname"><span class="pre">generate_params_qmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'halton'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grainlearning.sampling.generate_params_qmc" title="Permalink to this definition"></a></dt>
<dd><p>This is the class to uniformly draw samples in n-dimensional space from
a low-discrepancy sequence or a Latin hypercube.</p>
<p>See <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.qmc.html">Quasi-Monte Carlo</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_iter</strong> – maximum number of iterations, defaults to 100000</p></li>
<li><p><strong>expand_weight</strong> – weighted expansions, defaults to 10</p></li>
<li><p><strong>seed</strong> – random generation seed, defaults to None</p></li>
<li><p><strong>system</strong> (<em>Type</em><em>[</em><a class="reference internal" href="#grainlearning.dynamic_systems.DynamicSystem" title="grainlearning.dynamic_systems.DynamicSystem"><em>DynamicSystem</em></a><em>]</em>) – </p></li>
<li><p><strong>num_samples</strong> (<em>int</em>) – </p></li>
<li><p><strong>method</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="how_to_contribute.html" class="btn btn-neutral float-left" title="How to contribute" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Hongyang Cheng, Retief Lubbe, Luisa Orozco, Aron Jansen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>